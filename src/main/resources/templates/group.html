<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>群组管理</title>
    <link rel="stylesheet" href="css/bootstrap.css">
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.js"></script>
    <script type="text/javascript" src="js/vue.js"></script>
</head>
<body>
<div class="container">
    <h1 align="center" style="margin: 25px 0">
        <button type="button" class="btn btn-info" data-toggle="modal" data-target="#myModal" style="float:left;">
            添加群组
        </button>
        群列表
        <!-- 按钮：用于打开模态框 -->
    </h1>
    <table class="table table-hover table-bordered">
        <thead>
        <tr>
            <th>群头像</th>
            <th>群组名称</th>
            <th>群主账号</th>
            <th>群描述</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>群头像</td>
            <td>群组名称</td>
            <td>群主账号</td>
            <td>群描述</td>
        </tr>
        <tr>
            <td>群头像</td>
            <td>群组名称</td>
            <td>群主账号</td>
            <td>群描述</td>
        </tr>
        <tr>
            <td>群头像</td>
            <td>群组名称</td>
            <td>群主账号</td>
            <td>群描述</td>
        </tr>
        </tbody>
    </table>


    <!-- 模态框 -->
    <div class="modal fade" id="myModal">
        <div class="modal-dialog">
            <div class="modal-content">

                <!-- 模态框头部 -->
                <div class="modal-header">
                    <h4 class="modal-title">群组添加</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>

                <!-- 模态框主体 -->
                <div class="modal-body">
                    <div class="container" id="app">
                        <div class="form-group">
                            <label for="gname">群组名称:</label>
                            <input type="text" class="form-control" id="gname" v-model="gname">
                        </div>
                        <div class="form-group">
                            <label for="owner">群主账号:</label>
                            <input type="text" v-on:blur="queryUser" class="form-control" id="owner" v-model="owner">
                        </div>
                        <div class="form-group">
                            <label for="desc">群描述:</label>
                            <input type="text" class="form-control" id="desc" v-model="desc">
                        </div>
                        <div class="form-group" style="margin-top: 35px;">
                            <button type="button" class="btn btn-info btn-block btn-lg" v-on:click="submit_add_group">添加</button>
                        </div>
                    </div>
                </div>

                <!-- 模态框底部 -->
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">关闭</button>
                </div>

            </div>
        </div>
    </div>
</div>

<script>
var vm = new Vue({
    el:"#app",
    data:{
        owner:"", // 群主账号
        gname:"", // 群名称
        desc:"", // 群描述
    },
    methods:{
        queryUser:function(){
            console.log("owner = "+this.owner);
            $.get("/user/query/"+this.owner,function(result){
                if (result == null || result == "") {
                    alert("不可用指定群主为未注册的账号！！");
                }
            });
        },
        submit_add_group:function () {
            var owner = this.owner;
            var gname = this.gname;
            var desc = this.desc;
            if(owner == "" || gname == "" || desc == "") {
                alert("请完善创建群的信息！！");return;
            }
            $.post("/addgroup",{"owner":owner,"gname":gname,"desc":desc},function(result){
                console.log(result);
                if (result.code == 0 || result.code == "0") {
                    alert("群组创建成功！！");
                } else {
                    alert("创建群组异常，请及时联系管理员！");
                }
            });
        }
    }
});
</script>
</body>
</html>